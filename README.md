# Генерация пользовательского дерева трендов по И\О листу и OPC-карты 

## Лайтовая инструкция

### Общая Инфа
- Все Входные данные кидаем в папку Input - это i/o-лист(тест был на .xlsm ), config.json,Opc-карту
- При большой необходимости изменить входную\выходную папку, имя выходного файла - заходим в файл _publicConst.py

### Правила config.json
1. nameFile_IO - Имя i\o-листа (эксель файла)
2. prefix_Alpha - начало пути OPC одинаковое для всех структур в альфе

3. excel_settings - массив куда заливаются настройки по каждому отдельному листу (тренды)
   1. Name - Название структуры идущее после префикса (AI | AO и т.д.)
   2. ExcelSheet - имя страницы в экселе откуда брать данные 
   3. TreePath - имя папки отображаемой в трендах. Обязательно использовать двойной обратный слеш \\\ 
   4. Tag - указываем столбец из экселя откуда брать алгоритмическое имя (AlgName)
   5. Unit - указываем столбец из экселя откуда брать единицы измерения
   6. Description - указываем столбец из экселя откуда брать человеческое наименование сигнала 
   7. Postfix_Alpha - Окончание пути OPC-тега до нужного атрибута (AI_ToHMI.PV | DO_ToHMI.PV и т.д.)
   8. StartCount - число обозначающее с какой строки начинаются данные в листе



![Пояснялкины](pic.PNG)

<br>

4. nameFile_OpcMap - Имя карты (эксель файла)
5. binding_OpcMap 
5. addressSpace_OpcMap
7. typeId_OpcMap
8. shitty_wizard - массив патернов для разных структур (соответсвия альфы и регула)


----
## Запуск программы

Импорт нужных либ в проект 
> pip install -r requirements.txt

Запустите скрипт, выполнив следующую команду:
> python main.py

----
## Задачи
В разработке:
- [x] Сделать генерацию карты не столь колхозно 

Завершенные: 
- [x] Генерация файла Json (для трендов)
- [x] Чтение данных из экселя (для трендов)
- [x] Генерация дерева трендов  
- [x] Выгрузить файл с зависимостями 
- [x] Заполнение ОПС-карты в формате экселя
- [x] редактировать README
